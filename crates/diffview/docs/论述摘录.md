# 论述摘录（git 冲突解决与 diff 视图相关）

## Zed 尚未支持 split diff 的可能原因（推测）
- 优先级：主线精力在协作/性能/AI/扩展，split diff 体验排期靠后。
- UI/交互成本：双滚动同步、双 gutter、inline comment、键盘导航、折叠 unchanged 等需要成体系设计。
- 性能与虚拟化：大文件/大 hunk 的双栏行高同步、内联差异跨侧对齐需要更细的渲染与虚拟化管线。
- 代码结构：现有 diff/highlight 可能耦合单视图，抽象不足，拆出 split 渲染层有成本。
- 产品取舍：已有 inline diff 覆盖大部分需求，split 视图需求度低，暂未排期。
- 依赖功能：若想贴近 PR 体验需评论/导航等配套，增加复杂度。

## 面向 git conflict resolve 的基础能力（超出 diffview）
- 三方合并视图：base / ours / theirs 三栏或双栏 + 选择来源按钮，冲突块显示来源标记，支持逐块或逐行采纳、混合编辑。
- 冲突导航与提示：上一/下一冲突跳转，侧边标尺标记冲突/变更类型，顶部汇总。
- 暂存/丢弃操作：对文件/选中 hunk/行的 stage/unstage/revert，支持部分暂存，显示已暂存 vs 未暂存状态。
- Git 状态/文件列表：按仓库展示修改/未跟踪/冲突文件，过滤/分组/批量操作，多仓库根。
- 历史与对比：当前文件 log、逐 commit diff，任意两 commit/分支/暂存区对比。
- 内联工具条：忽略空白、展开/折叠未改动上下文、复制原/新内容、重置单行/单块。
- 高亮与注释：语法高亮 + 行内差异高亮；冲突块背景区分来源；可选内联评论/备注。
- 键盘导航：快速跳 hunk/冲突、采纳 ours/theirs、展开折叠、暂存。
- 文件操作安全网：保存前提示未解决冲突，显示未解决计数。
- 外部变更同步：文件被外部修改时提示重新加载，保留未保存编辑。
- 性能与虚拟化：大文件/大冲突流畅，三列行高同步与滚动同步。
- 视图模式：两栏对比、三栏冲突、单栏 inline，以及“解决冲突模式”切换。
- 选择与粘贴：块级选择、跨侧复制，保持缩进/空白一致性。

## 补充：当前实现取舍（本仓库）
- Git 操作：目前通过系统 `git` CLI（`std::process::Command`）完成，优先保证行为与真实工作流一致；后续可评估 `gix`/`libgit2` 以减少外部依赖。
- 冲突解决：先做 marker 解析与“逐块采纳→冲突清零→保存/`git add`”闭环，再逐步演进到 JetBrains 风格的“结果栏可编辑 + 最终写回”。
